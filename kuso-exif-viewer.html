<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuso EXIF æª¢è¦–å™¨ (V1.0 20251230)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- EXIF.js -->
    <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            dark: "#050a0e",
                            bg: "#111827",
                            cyan: "#00fff9",
                            pink: "#fe0056",
                            yellow: "#fcec0c",
                            green: "#39ff14",
                            text: "#e0f7fa"
                        }
                    },
                    fontFamily: {
                        mono: ['"Share Tech Mono"', '"Noto Sans TC"', 'monospace'],
                        sans: ['"Noto Sans TC"', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #050a0e;
            color: #e0f7fa;
            font-family: 'Noto Sans TC', sans-serif;
            overflow-x: hidden;
        }
        .neon-border-cyan { box-shadow: 0 0 5px #00fff9, inset 0 0 5px #00fff9; border: 1px solid #00fff9; }
        .neon-border-pink { box-shadow: 0 0 5px #fe0056, inset 0 0 5px #fe0056; border: 1px solid #fe0056; }
        .neon-border-yellow { box-shadow: 0 0 5px #fcec0c, inset 0 0 5px #fcec0c; border: 1px solid #fcec0c; }
        .neon-text-cyan { text-shadow: 0 0 5px #00fff9; }
        .neon-text-pink { text-shadow: 0 0 5px #fe0056; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00fff9; }

        .glitch-effect {
            position: relative;
        }
        .glitch-effect::before, .glitch-effect::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #050a0e;
        }
        .glitch-effect::before {
            left: 2px;
            text-shadow: -1px 0 #fe0056;
            clip: rect(24px, 550px, 90px, 0);
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }
        .glitch-effect::after {
            left: -2px;
            text-shadow: -1px 0 #00fff9;
            clip: rect(85px, 550px, 140px, 0);
            animation: glitch-anim 2.5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(10px, 9999px, 30px, 0); }
            20% { clip: rect(80px, 9999px, 100px, 0); }
            40% { clip: rect(30px, 9999px, 60px, 0); }
            60% { clip: rect(70px, 9999px, 110px, 0); }
            80% { clip: rect(20px, 9999px, 50px, 0); }
            100% { clip: rect(90px, 9999px, 130px, 0); }
        }
        @keyframes glitch-anim-2 {
            0% { clip: rect(60px, 9999px, 90px, 0); }
            20% { clip: rect(10px, 9999px, 50px, 0); }
            40% { clip: rect(90px, 9999px, 120px, 0); }
            60% { clip: rect(20px, 9999px, 60px, 0); }
            80% { clip: rect(70px, 9999px, 100px, 0); }
            100% { clip: rect(30px, 9999px, 70px, 0); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="border-b border-cyber-bg p-4 bg-cyber-bg shadow-lg z-10">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 class="text-2xl md:text-3xl font-bold text-cyber-cyan font-mono tracking-tighter neon-text-cyan glitch-effect" data-text="Kuso EXIF æª¢è¦–å™¨ (V1.0 20251230)">
                Kuso EXIF æª¢è¦–å™¨ (V1.0 20251230)
            </h1>
            <div class="text-xs text-cyber-yellow font-mono hidden md:block">
                SYS.STATUS: ONLINE // 20251230
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow p-4 md:p-6 max-w-7xl mx-auto w-full flex flex-col gap-6">

        <!-- Top Section: Image Preview & Upload -->
        <div class="w-full relative group">
            <input type="file" id="file-input" class="hidden" accept="image/jpeg,image/jpg,image/png,image/webp">
            <div id="drop-zone" class="w-full h-[400px] bg-cyber-bg border-2 border-dashed border-cyber-cyan/30 rounded-lg flex flex-col justify-center items-center cursor-pointer transition-all hover:border-cyber-cyan hover:bg-cyber-bg/80 relative overflow-hidden group">
                
                <!-- Preview Image -->
                <img id="preview-image" class="absolute w-full h-full object-contain opacity-0 transition-opacity duration-300 z-10" />
                
                <!-- Placeholder -->
                <div id="placeholder" class="text-center z-0 transition-opacity duration-300">
                    <i class="fa-solid fa-cloud-arrow-up text-5xl text-cyber-cyan mb-4 animate-bounce"></i>
                    <h3 class="text-xl font-bold text-cyber-text mb-2">æ‹–æ›³å½±åƒè³‡æ–™è‡³æ­¤è¼‰å…¥</h3>
                    <p class="text-sm text-gray-500 font-mono">æˆ–é»æ“Šæ­¤è™•é¸æ“‡æª”æ¡ˆ (JPG/PNG)</p>
                </div>

                <!-- Overlay Hint -->
                <div class="absolute bottom-4 right-4 bg-cyber-dark/80 px-3 py-1 rounded text-xs text-cyber-yellow font-mono border border-cyber-yellow opacity-0 group-hover:opacity-100 transition-opacity z-20">
                    [ SYSTEM: WAITING_FOR_INPUT ]
                </div>
            </div>
        </div>

        <!-- Middle Section: Data Grids -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <!-- Gear List (Yellow) -->
            <div class="bg-cyber-bg border-l-4 border-cyber-yellow p-1 rounded-r-lg shadow-[0_0_15px_rgba(252,236,12,0.1)]">
                <div class="bg-cyber-dark/50 h-full p-4 rounded relative overflow-hidden">
                    <h2 class="text-cyber-yellow font-bold text-xl mb-4 flex items-center font-mono border-b border-cyber-yellow/30 pb-2">
                        <i class="fa-solid fa-camera mr-2"></i> [ è£å‚™æ¸…å–® // GEAR_LIST ]
                    </h2>
                    <div id="gear-list-content" class="font-mono text-sm leading-relaxed space-y-2 min-h-[150px]">
                        <p class="text-gray-500 italic">>> ç­‰å¾…æ•¸æ“šæ³¨å…¥...</p>
                    </div>
                </div>
            </div>

            <!-- Exposure Data (Pink) -->
            <div class="bg-cyber-bg border-l-4 border-cyber-pink p-1 rounded-r-lg shadow-[0_0_15px_rgba(254,0,86,0.1)]">
                <div class="bg-cyber-dark/50 h-full p-4 rounded relative overflow-hidden">
                    <h2 class="text-cyber-pink font-bold text-xl mb-4 flex items-center font-mono border-b border-cyber-pink/30 pb-2">
                        <i class="fa-solid fa-bolt mr-2"></i> [ å‰ä¸–ä»Šç”Ÿ // EXPOSURE ]
                    </h2>
                    <div id="exposure-content" class="font-mono text-sm leading-relaxed space-y-2 min-h-[150px]">
                        <p class="text-gray-500 italic">>> ç­‰å¾…æ•¸æ“šæ³¨å…¥...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Bar -->
        <div class="flex justify-center mt-2">
            <button id="export-btn" class="bg-cyber-green/10 hover:bg-cyber-green/20 text-cyber-green border border-cyber-green font-bold py-3 px-8 rounded flex items-center gap-2 transition-all hover:shadow-[0_0_15px_rgba(57,255,20,0.3)] disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fa-solid fa-file-export"></i> è¼¸å‡ºç…§ç‰‡èº«ä»½è­‰ (.txt)
            </button>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-cyber-bg border-t border-cyber-dark p-6 mt-auto">
        <div class="max-w-7xl mx-auto flex flex-col items-center justify-center text-center gap-2">
            <p class="text-gray-400 text-sm">
                ç¨‹å¼è¨­è¨ˆï¼š<span class="text-cyber-cyan">è³€ç¦ç¦æ”å½±æ•™å®¤</span>
            </p>
            <p class="text-gray-500 text-xs font-mono">
                é€£çµ¡æ–¹å¼ï¼š<a href="mailto:hojenjen2018@gmail.com" class="hover:text-cyber-pink transition-colors">hojenjen2018@gmail.com</a>
            </p>
            <p class="text-[10px] text-gray-700 mt-2 font-mono">
                Â© 2025 KUSO EXIF VIEWER. ALL RIGHTS RESERVED.
            </p>
        </div>
    </footer>

    <!-- Quote Modal -->
    <div id="quote-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
        <div class="bg-cyber-bg border-2 border-cyber-pink max-w-lg w-[90%] p-1 relative transform scale-95 transition-transform duration-300" id="quote-box">
            <div class="bg-cyber-dark p-6 text-center relative overflow-hidden">
                <!-- Decorative Lines -->
                <div class="absolute top-0 left-0 w-full h-1 bg-cyber-pink"></div>
                <div class="absolute bottom-0 left-0 w-full h-1 bg-cyber-pink"></div>
                
                <h3 class="text-cyber-pink font-mono text-sm mb-4 tracking-widest">
                    // SYSTEM_OVERRIDE // éˆé­‚æ‹·å•ç¨‹åº //
                </h3>
                
                <p id="quote-text" class="text-xl md:text-2xl font-bold text-white leading-relaxed mb-8 neon-text-pink">
                    è¼‰å…¥ä¸­...
                </p>

                <button id="close-modal" class="bg-cyber-yellow text-cyber-dark font-bold py-2 px-6 rounded hover:bg-white transition-colors text-lg">
                    [ é»æ“Šé—œé–‰ ]
                </button>
            </div>
        </div>
    </div>

    <script>
        // Data Sources from Python Version
        const SOUL_QUOTES = [
            "ä½ ä¸æ˜¯å‡ç´šå™¨æï¼Œæ˜¯å»¶å¾Œé¢å°å¯¦åŠ›", "é˜²æ½®ç®±æ˜¯æ”å½±å¸«çš„å¤¢æƒ³å†°æ«ƒ", "å™¨æå…¨æ–°ï¼Œä½œå“å…¨ç„¡",
            "é¡é ­è¶Šè²´ï¼Œè¶Šä¸æ•¢å¸¶å‡ºé–€", "é¡é ­æ¯”ä½ çš„äººç”Ÿè¦åŠƒæ¸…æ¥š", "é–‹ç®±æ‹å¾—æ¯”ä½œå“èªçœŸ",
            "å™¨æè²·é½Šäº†ï¼Œæ‹ç…§é‚„åœ¨æ‰¾é¡Œæ", "ä½ ä¸æ˜¯å™¨æé»¨ï¼Œæ˜¯é€ƒé¿é»¨", "ç›¸æ©ŸçŸ¥é“ä½ å¾ˆçª®ï¼Œä½†ä½ è£ä½œä¸åœ¨ä¹",
            "æŠ€è¡“æ²’é€²æ­¥ï¼Œä½†é…ä»¶è¶Šä¾†è¶Šé½Š", "å…¨æ‰‹å‹•åªæ˜¯è®“éŒ¯èª¤æ›´æœ‰å°Šåš´", "ç”¨ M æ¨¡å¼æ‹çˆ›ï¼Œä¸æœƒæ¯”è¼ƒé«˜ç´š",
            "å…‰åœˆå…¨é–‹ä¸æ˜¯é¢¨æ ¼ï¼Œæ˜¯å¤±æ§", "å¿«é–€äº‚è½‰ï¼Œæ¨¡ç³Šç•¶å“²å­¸", "ISO çˆ†è¡¨ï¼Œå«æƒ…ç·’",
            "ä¸æœƒæ¸¬å…‰ï¼Œå»æ„›è«‡å…‰", "åƒæ•¸èƒŒå¾—ç†Ÿï¼Œç•«é¢é‚„æ˜¯æ­»", "ä½ åœ¨æ§åˆ¶ç›¸æ©Ÿï¼Œç›¸æ©Ÿåœ¨æ‡²ç½°ä½ ",
            "æ›å…‰è£œå„Ÿæ˜¯ä½ æœ€å¾Œçš„å¸Œæœ›", "ç™½å¹³è¡¡äº‚è·‘ï¼Œè‰²å½©é‚„æ•¢èªªã€Œè‡ªç„¶ã€", "æ¨¡ç³Šä¸æ˜¯è©©ï¼Œæ˜¯æ²’å°ç„¦",
            "é»‘ç™½ä¸æ˜¯æ·±åº¦ï¼Œæ˜¯é®ç¾", "æ¥µç°¡ä¸æ˜¯ä»€éº¼éƒ½æ²’æ‹åˆ°", "ç•™ç™½ç•™åˆ°åƒæ²’èµ°è¿‘",
            "å°ç¨±ä¸æ˜¯æ§‹åœ–ï¼Œæ˜¯æ€•å‡ºéŒ¯", "ä¸­å¤®æ§‹åœ–ç”¨ä¸€è¼©å­ï¼Œé‚„èªªæ˜¯é¢¨æ ¼", "å‰æ™¯äº‚æ”¾å«è¨­è¨ˆ",
            "å»£è§’è²¼è‡‰å«éœ‡æ’¼", "èƒŒæ™¯äº‚ä¸æ˜¯ç´€å¯¦ï¼Œæ˜¯ä¸è² è²¬", "çœ‹ä¸æ‡‚ä¸æ˜¯é«˜ç´šï¼Œæ˜¯æ²’èªªæ¸…æ¥š",
            "æ¨¡ç‰¹æ¼‚äº®ï¼Œä¸æ˜¯ä½ çš„åŠŸå‹", "æ•£æ™¯ä¸æ˜¯æƒ…æ„Ÿï¼Œæ˜¯èƒŒæ™¯ç³Šæ‰", "çœ¼ç¥ç©ºï¼Œä¸æ˜¯æ†‚é¬±ï¼Œæ˜¯æ²’å¼•å°",
            "æ¨¡ç‰¹åœ¨æ’ï¼Œä½ åœ¨è‡ªçˆ½", "å§¿å‹¢ä¸€æ¨£ï¼Œåªæ˜¯æ›äºº", "ä¿®çš®ä¿®åˆ°åƒå¡‘è† ï¼Œé‚„èªªçœŸå¯¦",
            "äººåƒä¸æ˜¯æ‹è‡‰éƒ¨è­‰ä»¶", "æ¨¡ç‰¹æ•‘äº†ä½ ï¼Œä½ é‚„ä»¥ç‚ºæ˜¯è‡ªå·±", "å·æ‹ä¸æ˜¯è¡—æ‹ï¼Œæ˜¯æ²’å‹‡æ°£",
            "è¢«æ‹’æ‹å°±èªªè‡ªå·±åœ¨åšè—è¡“", "å¾Œè£½ä¸æ˜¯å‰µä½œï¼Œæ˜¯æ€¥æ•‘", "æ¿¾é¡æ¯”å…§å®¹é‡",
            "é¡è‰²å¾ˆçŒ›ï¼Œæƒ…ç·’ç‚ºé›¶", "ä¿®åˆ°ä¸åƒäººï¼Œé‚„èªªè‡ªç„¶", "Lightroom ä¸æ˜¯è´–ç½ªåˆ¸",
            "ä¿®åœ–ä¿®åˆ°å¿˜è¨˜åŸæœ¬æƒ³æ‹ä»€éº¼", "å°æ¯”æ‹‰æ»¿ï¼Œæ•…äº‹æ¶ˆå¤±", "ä¸€éµé¢¨æ ¼ä¸æ˜¯é¢¨æ ¼",
            "HDR ä¸æ˜¯è®“äººçœ¼ç›æµè¡€", "å¾Œè£½æ™‚é–“æ¯”æ€è€ƒæ™‚é–“é•·", "æ²’é¢¨æ ¼ä¸å«å¤šå…ƒ",
            "æ¨¡ä»¿å¤ªåƒï¼Œå°±æ˜¯æŠ„", "æ¯å¼µéƒ½ä¸åŒï¼Œå…¶å¯¦éƒ½ä¸è¡Œ", "é»‘æš—ä¸æ˜¯æ·±æ²‰ï¼Œæ˜¯ç©º",
            "é¢¨æ ¼ä¸æ˜¯ä½ èªªäº†ç®—ï¼Œæ˜¯ä½œå“èªªäº†ç®—", "æ‹å¾ˆå¤šï¼Œä¸ä»£è¡¨æ‹å¾—å¥½", "å¿«é–€ç´¯ç©ï¼Œä¸ç­‰æ–¼æˆé•·",
            "ä½ èªªåœ¨æ‰¾é¢¨æ ¼ï¼Œå…¶å¯¦åœ¨æ‹–", "ä½œå“é›†åƒè·³èš¤å¸‚å ´", "ä½ è©²åˆªçš„æ¯”è©²ç•™çš„å¤š",
            "è®šå¤šä¸æ˜¯è­‰æ˜ï¼Œåªæ˜¯é‹æ°£", "è®šå°‘ä¹Ÿä¸ä»£è¡¨ä½ æ˜¯è—è¡“å®¶", "æ¼”ç®—æ³•ä¸æ˜¯ä½ çš„æ•µäººï¼Œæ˜¯ç…§å¦–é¡",
            "è¢«åˆ†äº«ä¸ä»£è¡¨è¢«ç†è§£", "æµé‡ä¾†å¾—å¿«ï¼Œä½ ä¹Ÿç©ºå¾—å¿«", "æ¨™ç±¤ä¸‹å¾—æº–ï¼Œç…§ç‰‡é‚„æ˜¯çˆ›",
            "æ–‡æ¡ˆæ¯”ç…§ç‰‡ç²¾å½©", "ç‚ºäº†æµé‡æ‹ï¼Œæœ€å¾Œåªå‰©æµé‡", "ç†±é–€æ§‹åœ–ä¸æ˜¯ä½ çš„é¢¨æ ¼",
            "æ¯å¼µéƒ½æƒ³çˆ†ï¼Œå…¶å¯¦æ²’ä¸€å¼µç«™å¾—ä½", "æ‹å¾ˆä¹…ï¼Œä¸ä»£è¡¨ä½ é€²æ­¥", "è€æ‰‹äº‚æ‹ï¼Œæ–°æ‰‹çœ‹ä¸å‡ºä¾†",
            "æ–°æ‰‹æ‹å¾—å¥½ï¼Œå°±æ˜¯å¥½", "è½ä¸é€²æ‰¹è©•çš„äººæœ€å±éšª", "ä¸€ç›´è¾¯è§£ï¼Œä»£è¡¨ä½ çŸ¥é“ä¸è¡Œ",
            "æ€ªå™¨æçš„äººä¸æƒ³é¢å°è‡ªå·±", "è‡ªç¨±è—è¡“å®¶çš„äººé€šå¸¸æœ€æ€•è¢«çœ‹æ‡‚", "æ”å½±ä¸æ˜¯é ­éŠœ",
            "æ‹ç…§ä¸æ˜¯é€ƒé¿æ€è€ƒ", "ç›¸æ©Ÿä¸æœƒå¹«ä½ åšé¸æ“‡", "å¥½ç…§ç‰‡ä¸ç”¨è§£é‡‹",
            "è§£é‡‹è¶Šå¤šï¼Œç…§ç‰‡è¶Šå¼±", "çœ‹ä¸å‡ºä½ æƒ³æ‹ä»€éº¼", "ã€Œæœ‰æ„Ÿè¦ºä½†èªªä¸å‡ºä¾†ã€ï¼æ²’å®Œæˆ",
            "æŠ€è¡“åˆ°ä½ï¼Œå…§å®¹ç¼ºå¸­", "æ‹å¾—æ¸…æ¥šï¼Œä¸ç­‰æ–¼æ‹å¾—å¥½", "ä½ å¾ˆåŠªåŠ›ï¼Œä½†ç…§ç‰‡æ²’æ”¶åˆ°",
            "ç›¸æ©Ÿå¾ˆé«˜ç´šï¼Œç…§ç‰‡å¾ˆæ™®é€š", "é€™å¼µä¸æ˜¯çˆ›ï¼Œæ˜¯æµªè²»", "æ²’å¤±æ•—ï¼Œä¸ä»£è¡¨æˆåŠŸ",
            "å¥½ç…§ç‰‡ä¸éœ€è¦å¾ˆå¤š", "åå¼µä¸€å¼µå°±å¾ˆå¼·", "åˆªç…§ç‰‡ä¹Ÿæ˜¯å‰µä½œ",
            "æ‹ç…§æ˜¯é¸æ“‡ï¼Œä¸æ˜¯å…¨æ”¶", "ä¸æ‹ï¼Œæœ‰æ™‚æ¯”äº‚æ‹å¥½", "ç›¸æ©Ÿæœƒéæ™‚ï¼Œçœ¼ç›ä¸æœƒ",
            "çœ‹å¾—å°‘ï¼Œæ‹å†å¤šéƒ½æ²’ç”¨", "ä½ æœ€å¾Œåªæœƒæ‹çµ¦è‡ªå·±çœ‹", "æ”å½±ä¸æ˜¯è­‰æ˜ä½ æœ‰å¤šå²å®³",
            "æ‹ç…§ï¼Œæœ€å¾Œæ˜¯åœ¨å°ä»˜è‡ªå·±"
        ];

        const BRAND_COMMENTS = {
            "canon": "Canonï¼ˆä½³èƒ½ï¼‰<br>ğŸ‘‰ ã€Œä½³èƒ½ï¼šå¤§å®¶ç¬¬ä¸€å°ç›¸æ©Ÿï¼Œè€å¸«ã€è¨˜è€…ã€å©šæ”éƒ½ç”¨å®ƒã€‚ã€",
            "nikon": "Nikonï¼ˆå°¼åº·ï¼‰<br>ğŸ‘‰ ã€Œå°¼åº·ï¼šæˆ‘ä¸è·Ÿæµè¡Œï¼Œæˆ‘åªè·Ÿå…‰ç·šè¬›é“ç†ã€‚ã€",
            "fujifilm": "Fujifilmï¼ˆå¯Œå£«ï¼‰<br>ğŸ‘‰ ã€Œå¯Œå£«ï¼šå“‡ï¼Œä½ æ˜¯å¯Œå®¶å­å¼Ÿï¼Œé€£é¡è‰²éƒ½å¾ˆæœ‰æ•™é¤Šã€‚ã€",
            "panasonic": "Panasonicï¼ˆæ¾ä¸‹ï¼‰<br>ğŸ‘‰ ã€Œæ¾ä¸‹ï¼šæˆ‘æ‹ç…§é‚„è¡Œï¼Œä½†æˆ‘å…¶å¯¦æ˜¯ä¾†æ‹é›»å½±çš„ã€‚ã€",
            "olympus": "OM System / Olympus<br>ğŸ‘‰ ã€Œå¥§æ—å·´æ–¯ï¼šæˆ‘å¾ˆå°ï¼Œä½†æˆ‘é™ªä½ ä¸Šå±±ä¸‹æµ·ã€‚ã€",
            "om digital": "OM System / Olympus<br>ğŸ‘‰ ã€Œå¥§æ—å·´æ–¯ï¼šæˆ‘å¾ˆå°ï¼Œä½†æˆ‘é™ªä½ ä¸Šå±±ä¸‹æµ·ã€‚ã€",
            "leica": "Leicaï¼ˆå¾ å¡ï¼‰<br>ğŸ‘‰ ã€Œå¾ å¡ï¼šä½ è²·çš„ä¸æ˜¯ç›¸æ©Ÿï¼Œæ˜¯ä¿¡ä»°èˆ‡ç´…é»ã€‚ã€",
            "pentax": "Pentaxï¼ˆè³“å¾—ï¼‰<br>ğŸ‘‰ ã€Œè³“å¾—ï¼šå¤§å®¶éƒ½å¿˜äº†æˆ‘ï¼Œä½†æˆ‘è‡ªå·±å¾ˆé©•å‚²ã€‚ã€",
            "hasselblad": "Hasselbladï¼ˆå“ˆè˜‡ï¼‰<br>ğŸ‘‰ ã€Œå“ˆè˜‡ï¼šæˆ‘ä¸€å¼µç…§ç‰‡ï¼Œç­‰æ–¼ä½ ä¸€å°é›»è…¦ã€‚ã€",
            "blackmagic": "Blackmagic Design<br>ğŸ‘‰ ã€ŒBlackmagicï¼šæ‹ç…§ï¼Ÿä¸ï¼Œæˆ‘åªæ´»åœ¨å‰ªæ¥è»Ÿé«”è£¡ã€‚ã€",
            "sony": "Sonyï¼ˆç´¢å°¼ï¼‰<br>ğŸ‘‰ ã€ŒSonyï¼šå°ç„¦æ¯”ä½ äººç”Ÿç›®æ¨™é‚„å¿«ã€‚ã€",
            "apple": "Appleï¼ˆè˜‹æœï¼‰<br>ğŸ‘‰ ã€Œä½ è²·çš„ä¸æ˜¯æ‰‹æ©Ÿï¼Œæ˜¯ç”Ÿæ…‹ç³»å…¥å ´åˆ¸ã€‚ã€",
            "iphone": "Appleï¼ˆè˜‹æœï¼‰<br>ğŸ‘‰ ã€Œä½ è²·çš„ä¸æ˜¯æ‰‹æ©Ÿï¼Œæ˜¯ç”Ÿæ…‹ç³»å…¥å ´åˆ¸ã€‚ã€",
            "samsung": "Samsungï¼ˆä¸‰æ˜Ÿï¼‰<br>ğŸ‘‰ ã€Œå‹è™Ÿå¤šåˆ°é€£è‡ªå·±éƒ½éœ€è¦åˆ†é¡è¡¨ã€‚ã€",
            "google": "Googleï¼ˆPixelï¼‰<br>ğŸ‘‰ ã€Œç¡¬é«”æ™®é€šï¼Œä½†æˆ‘æ˜¯ AI è¦ªå…’å­ã€‚ã€",
            "pixel": "Googleï¼ˆPixelï¼‰<br>ğŸ‘‰ ã€Œç¡¬é«”æ™®é€šï¼Œä½†æˆ‘æ˜¯ AI è¦ªå…’å­ã€‚ã€"
            // (ç‚ºäº†ä¿æŒç°¡æ½”ï¼Œå…¶ä»–å“ç‰Œé‚è¼¯é€šç”¨ï¼Œè‹¥ç„¡ç‰¹å®šå‰‡é¡¯ç¤ºç„¡)
        };

        // DOM Elements
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const previewImage = document.getElementById('preview-image');
        const placeholder = document.getElementById('placeholder');
        const gearListContent = document.getElementById('gear-list-content');
        const exposureContent = document.getElementById('exposure-content');
        const quoteModal = document.getElementById('quote-modal');
        const quoteBox = document.getElementById('quote-box');
        const quoteText = document.getElementById('quote-text');
        const closeModal = document.getElementById('close-modal');
        const exportBtn = document.getElementById('export-btn');

        let currentExifData = null;

        // Event Listeners
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('border-cyber-cyan', 'bg-cyber-bg/80');
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('border-cyber-cyan', 'bg-cyber-bg/80');
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-cyber-cyan', 'bg-cyber-bg/80');
            const file = e.dataTransfer.files[0];
            if (file) handleFile(file);
        });
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleFile(file);
        });

        // Modal Logic
        function showQuote() {
            const randomQuote = SOUL_QUOTES[Math.floor(Math.random() * SOUL_QUOTES.length)];
            quoteText.textContent = randomQuote;
            
            quoteModal.classList.remove('hidden');
            // Small delay for transition
            setTimeout(() => {
                quoteModal.classList.remove('opacity-0');
                quoteBox.classList.remove('scale-95');
                quoteBox.classList.add('scale-100');
            }, 10);
        }

        closeModal.addEventListener('click', () => {
            quoteModal.classList.add('opacity-0');
            quoteBox.classList.remove('scale-100');
            quoteBox.classList.add('scale-95');
            setTimeout(() => {
                quoteModal.classList.add('hidden');
            }, 300);
        });

        // Main File Handling
        function handleFile(file) {
            if (!file.type.match('image.*')) {
                alert("åªèƒ½è®€å–å½±åƒæª”å–”ï¼(JPG/PNG/WebP)");
                return;
            }

            // Read for Preview
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImage.src = e.target.result;
                previewImage.classList.remove('opacity-0');
                placeholder.classList.add('opacity-0');
                
                // Read EXIF
                // We need to use the image object for EXIF.js
                // But EXIF.js works better if we let it load the image itself or pass the element
                // Here we use the previewImage element which now has the src
                setTimeout(() => {
                    EXIF.getData(previewImage, function() {
                        const allMetaData = EXIF.getAllTags(this);
                        processExifData(allMetaData, file);
                        showQuote();
                    });
                }, 100);
            };
            reader.readAsDataURL(file);
        }

        function processExifData(data, file) {
            // Safe Getters
            const make = data.Make || "Unknown Make";
            const model = data.Model || "Unknown Model";
            const lens = data.LensModel || "æˆ‘æ²’æœ‰çœ¼é¡";
            const date = data.DateTimeOriginal || data.DateTime || "";
            const width = data.PixelXDimension || "?";
            const height = data.PixelYDimension || "?";
            const sizeMB = (file.size / (1024 * 1024)).toFixed(2);

            // Logic Port: Exposure Program
            let expModeStr = "ä½ äº‚æ‹å°å§?";
            const prog = data.ExposureProgram; // 1:M, 2:P, 3:Av, 4:Sv
            if (prog === 1) expModeStr = "M = Magic Modeï¼ˆé­”æ³•æ¨¡å¼ï¼‰ ğŸ‘‰ æ–°æ‰‹ä»¥ç‚ºé€²å»æœƒè‡ªå‹•è®Šå¼·";
            else if (prog === 2) expModeStr = "P = Pray Modeï¼ˆç¥ˆç¦±æ¨¡å¼ï¼‰ ğŸ‘‰ å¸Œæœ›ç›¸æ©Ÿæ‡‚æˆ‘";
            else if (prog === 3) expModeStr = "Av = Art Vision æ¨¡å¼ï¼ˆè—è¡“è¦–è§’ï¼‰ ğŸ‘‰ èƒŒæ™¯èƒ½ç³Šå°±æ˜¯å¥½ç…§ç‰‡";
            else if (prog === 4) expModeStr = "S = Stop That Motion æ¨¡å¼ ğŸ‘‰ ä¸å‡†å‹•ï¼";
            else if (prog === 0) expModeStr = "Auto = Blame the Camera Modeï¼ˆå‡ºäº‹æ€ªç›¸æ©Ÿï¼‰";

            // Logic Port: Shutter
            let shutterStr = "åˆ¥çœ‹é€™ï¼Œæ²’è³‡æ–™";
            if (data.ExposureTime) {
                const val = parseFloat(data.ExposureTime);
                if (val < 1) shutterStr = `1/${Math.round(1/val)}`;
                else shutterStr = `${val} ç§’`;
            }

            // Logic Port: Aperture
            let fStr = "å¤§æ¦‚æ²’è£é¡é ­å§?";
            if (data.FNumber) fStr = `f/${data.FNumber}`;

            // Logic Port: ISO
            const isoStr = data.ISOSpeedRatings ? `ISO ${data.ISOSpeedRatings}` : "æˆ‘è®€ä¸åˆ°åˆ¥å•æˆ‘";

            // Logic Port: Focal Length
            const flStr = data.FocalLength ? `${data.FocalLength} mm` : "æˆ‘ç´¯äº†";

            // Logic Port: Brand Quote
            let brandQuote = "";
            const makeLower = make.toLowerCase();
            const modelLower = model.toLowerCase();
            
            // Sony Special Case
            if (makeLower.includes("sony")) {
                if (modelLower.includes("xperia")) brandQuote = "Sonyï¼ˆç´¢å°¼ï¼‰<br>ğŸ‘‰ ã€Œç›¸æ©Ÿéƒ¨é–€å¾ˆå¼·ï¼Œä½†æ‰‹æ©Ÿåªæƒ³åšçµ¦æ‡‚çš„äººã€‚ã€";
                else brandQuote = BRAND_COMMENTS["sony"];
            } else {
                for (const key in BRAND_COMMENTS) {
                    if (makeLower.includes(key)) {
                        brandQuote = BRAND_COMMENTS[key];
                        break;
                    }
                }
            }

            // Logic Port: Date Analysis
            let timeMachine = "æˆ‘æ²’æœ‰ç”Ÿæ—¥";
            if (date) {
                // EXIF date format is usually "YYYY:MM:DD HH:MM:SS"
                const parts = date.split(' ')[0].split(':');
                if (parts.length === 3) {
                    const year = parseInt(parts[0]);
                    let comment = "";
                    if (year >= 2024) comment = "ã€Œé‚„åœ¨ä¿å›ºå…§ã€<br>ğŸ‘‰ è¨˜æ†¶æ–°é®®ã€ç¡¬ç¢Ÿé‚„æ²’å£<br>ğŸ‘‰ ã€Œé€™ä¸æ˜¯èˆŠç…§ï¼Œæ˜¯å›é¡§ã€";
                    else if (year >= 2023) comment = "ã€Œæ™‚é–“éå¥½å¿«æ¨¡å¼ã€<br>ğŸ‘‰ æ‹çš„æ™‚å€™æ˜æ˜æ˜¯æ˜¨å¤©<br>ğŸ‘‰ ã€Œæ€éº¼å·²ç¶“å…©å¹´äº†ï¼Ÿã€";
                    else if (year >= 2022) comment = "ã€Œç–«æƒ…å¾Œéºç…§ï¼ˆæƒ…æ„Ÿç‰ˆï¼‰ã€<br>ğŸ‘‰ äººé‚„åœ¨ï¼Œæ„Ÿè¦ºä¸ä¸€æ¨£äº†<br>ğŸ‘‰ ã€Œé‚£æ™‚å€™çš„æˆ‘ï¼Œå¥½ç˜¦ / å¥½å¤©çœŸã€";
                    else if (year >= 2021) comment = "ã€Œæ™‚ä»£äº¤ç•Œç·šã€<br>ğŸ‘‰ æ‹ç…§è¨­å‚™å·²è¢«å«ŒèˆŠ<br>ğŸ‘‰ ã€Œé€™æ˜¯å‰ä¸€æ”¯æ‰‹æ©Ÿæ‹çš„ã€";
                    else if (year >= 2020) comment = "ã€Œå“‡é ï¼Œå·²ç¶“äº”å¹´äº†ã€<br>ğŸ‘‰ æ­£å¼é€²å…¥æ‡·èˆŠå€<br>ğŸ‘‰ ã€Œé€™å¼µç¾åœ¨çœ‹æœ‰é»æ„Ÿæƒ…ã€";
                    else if (year >= 2015) comment = "ã€Œç¶“å…¸è€ç…§ç‰‡ã€<br>ğŸ‘‰ æ¿¾é¡é–‹å§‹æœ‰å¹´ä»£æ„Ÿ<br>ğŸ‘‰ ã€Œé€™æ˜¯æˆ‘ä»¥å‰çš„é¢¨æ ¼ã€ï¼ˆ= ä¸æƒ³æ‰¿èªï¼‰";
                    else if (year >= 2000) comment = "ã€Œæ­·å²æ–‡ä»¶ç­‰ç´šã€<br>ğŸ‘‰ äººç‰©å¤–å‹å·®å¾ˆå¤š<br>ğŸ‘‰ ã€Œé‚£æ™‚å€™å¤§å®¶éƒ½é€™æ¨£ç©¿ã€";
                    else comment = "ã€Œè€ƒå¤ç¾å ´ã€<br>ğŸ‘‰ ç•«è³ªæ„Ÿäººã€è¡¨æƒ…çœŸèª <br>ğŸ‘‰ ã€Œé€™å¼µè¦å°å¿ƒæ‹¿ã€";
                    
                    timeMachine = `${parts.join('-')} <br><br><span class="text-cyber-pink">[ æ™‚å…‰æ©Ÿåˆ†æ ]</span><br>${comment}`;
                }
            }

            // Build HTML Strings
            const gearHtml = `
                <div class="mb-2"><span class="text-gray-400">DEVICE:</span> <span class="text-white font-bold">${make} ${model}</span></div>
                <div class="mb-2"><span class="text-gray-400">LENS:</span> <span class="text-white">${lens}</span></div>
                <div class="mb-2"><span class="text-gray-400">DATE:</span> <span class="text-cyber-green">${date}</span></div>
                <div class="mb-2"><span class="text-gray-400">SIZE:</span> ${width}x${height} (${sizeMB} MB)</div>
                ${brandQuote ? `<div class="mt-4 p-2 bg-cyber-yellow/10 border border-cyber-yellow text-cyber-yellow text-xs">${brandQuote}</div>` : ''}
            `;

            const exposureHtml = `
                <div class="mb-2"><span class="text-gray-400">MODE:</span> <span class="text-cyber-pink">${expModeStr}</span></div>
                <div class="mb-2"><span class="text-gray-400">SHUTTER:</span> <span class="text-white">${shutterStr}</span></div>
                <div class="mb-2"><span class="text-gray-400">APERTURE:</span> <span class="text-white">${fStr}</span></div>
                <div class="mb-2"><span class="text-gray-400">ISO:</span> <span class="text-white">${isoStr}</span></div>
                <div class="mb-2"><span class="text-gray-400">FOCAL:</span> <span class="text-white">${flStr}</span></div>
                <div class="mt-4 pt-4 border-t border-cyber-bg text-sm text-gray-300 leading-relaxed">${timeMachine}</div>
            `;

            // Update DOM
            gearListContent.innerHTML = gearHtml;
            exposureContent.innerHTML = exposureHtml;

            // Save Data for Export
            currentExifData = {
                filename: file.name,
                basic: gearHtml.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim(),
                exposure: exposureHtml.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim()
            };
            exportBtn.disabled = false;
        }

        // Export Function
        exportBtn.addEventListener('click', () => {
            if (!currentExifData) return;
            
            const textContent = `// CYBERDECK EXIF ANALYSIS LOG //\n` +
                `TARGET_FILE: ${currentExifData.filename}\n\n` +
                `[ GEAR_LIST ]\n${currentExifData.basic}\n\n` +
                `[ EXPOSURE_DATA ]\n${currentExifData.exposure}\n\n` +
                `GENERATED BY KUSO EXIF VIEWER (WEB)`;
            
            const blob = new Blob([textContent], { type: "text/plain;charset=utf-8" });
            const filename = `EXIF_LOG_${new Date().toISOString().slice(0,10)}.txt`;
            
            // Simple download link creation
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
        });

    </script>
</body>
</html>